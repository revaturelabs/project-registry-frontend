<h1 id="anime" class="welcome">Project Registry</h1>

<button class="reset-btn"
          mat-flat-button
          matTooltip="Reset Filters"
          type="reset"
          (click)="reset()"
          value="Reset Filters"
         
          >  
          <mat-icon>
            <span class="material-icons-outlined">
                restart_alt
          </span></mat-icon>
          </button>

<form>
  <div class="container">
    <mat-card>
      <!-- Search By ID -->
      <mat-grid-list cols="8" rowHeight="1:0.5">

        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>ID</mat-label>
            <input matInput class="from-control" (keyup)="applyFilter($event)" placeholder="ID" #input />
          </mat-form-field>
        </mat-grid-tile>
        <!-- Search By Name available -->

        <!-- Search By Tag available -->
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Name</mat-label>
            <input matInput class="from-control" (keyup)="applyFilter($event)" placeholder="Name" #input />
          </mat-form-field>
        </mat-grid-tile>

        <!-- Search by Status -->
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Status</mat-label>
            <mat-select name="statusList" (selectionChange)="filterStatus($event)" [(ngModel)]="statusSelected">
              <mat-option value="noStatus">Select a status...</mat-option>

              <!-- Where is it grabbing statuses from? if DB we need to fill in values for devlopment-->
              <mat-option value="ACTIVE">Active</mat-option>
              <mat-option value="CODE_REVIEW">Code-Review</mat-option>
              <mat-option value="FINISH">Finished</mat-option>

              <mat-option *ngFor="let statuses of status" value="{{ statuses }}">
                {{ statuses }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </mat-grid-tile>

        <!-- Search By Phase status -->
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Phase</mat-label>
            <mat-select name="phaseList" (selectionChange)="filterPhase($event)" [(ngModel)]="phaseSelected">
              <mat-option value="noPhase">Select a Phase...</mat-option>
              <mat-option *ngFor="let fase of phase" value="{{ fase.kind }}">
                {{ fase.kind }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </mat-grid-tile>


        <!-- Search By Description -->
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Description</mat-label>
            <mat-select name="allBatches" (selectionChange)="filterIteration($event)">
              <mat-option value="">Select an Iterator...</mat-option>
              <mat-option *ngFor="let i of allBatches" value="{{i.batchId}}">
                {{i.startDate}} {{i.location}} {{i.skill}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </mat-grid-tile>

        <!-- Search By Owner -->

        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Owner</mat-label>
            <mat-select name="allBatches" (selectionChange)="filterIteration($event)">
              <mat-option value="">Select an Iterator...</mat-option>
              <mat-option *ngFor="let i of allBatches" value="{{i.batchId}}">
                {{i.startDate}} {{i.location}} {{i.skill}}

              </mat-option>
            </mat-select>
          </mat-form-field>
        </mat-grid-tile>

        <!-- Search By Tags-->
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Tags</mat-label>
            <mat-select
            name="tagList"
            (selectionChange)="filterTag($event)"
            [(ngModel)]="tagSelected"
          >
            <mat-option value="noTag">Select a tag...</mat-option>
            <mat-option *ngFor="let tags of tag" value="{{ tags.name }}">
              {{ tags.name }}
            </mat-option>
          </mat-select>
          </mat-form-field>
        </mat-grid-tile>

        <!--Search By Iteration-->
        <mat-grid-tile>
          <mat-form-field appearance="fill">
            <mat-label>Iteration</mat-label>
            <mat-select name="allBatches" (selectionChange)="filterIteration($event)">
              <mat-option value="">Select an Iterator...</mat-option>
              <mat-option *ngFor="let i of allBatches" value="{{i.batchId}}">
                {{i.startDate}} {{i.location}} {{i.skill}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </mat-grid-tile>

        <!-- Reset button -->
        
     
         
      </mat-grid-list>
      


      

      <div class="mat-elevation-z8">
        <table mat-table [dataSource]="dataSource" matSort>
          <!-- ID Column -->
          <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="mat-id">ID</th>
            <td matTooltip="Click to get project-detail" mat-cell *matCellDef="let row" (click)="rowClicked(row.id)">
              {{ row.id }}
            </td>
          </ng-container>

          <!-- name Column -->
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
            <td mat-cell *matCellDef="let row" (click)="rowClicked(row.id)">
              {{ row.name }}
            </td>
          </ng-container>




          <!-- status Column -->
          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
            <td mat-cell *matCellDef="let row" (click)="rowClicked(row.id)">
              {{ row.status.name }}
            </td>
          </ng-container>






          <!-- phase Column -->
          <ng-container matColumnDef="phase">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Phase</th>
            <td mat-cell *matCellDef="let row">{{ row.phase?.kind }}</td>
          </ng-container>

          <!-- description Column -->
          <ng-container matColumnDef="description">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              Description
            </th>
            <td mat-cell *matCellDef="let row" (click)="rowClicked(row.id)">
              {{ row.description }}
            </td>
          </ng-container>
          <!-- Owner Column -->
          <ng-container matColumnDef="owner">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Owner</th>
            <td mat-cell *matCellDef="let row" (click)="rowClicked(row.id)">
              {{ row.owner.username }}
            </td>
          </ng-container>

          <!-- Tags Column -->
        <!--on main page, gets rows of tags-->
          <ng-container matColumnDef="tags">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Tags</th>
            <td mat-cell *matCellDef="let row" (click)="rowClicked(row.id)">
              <span *ngFor="let in of row.tags">
                {{ in.name }}
              </span>
            </td>
          </ng-container>


          <!-- ------------------- Group 5 ----------------------- -->
          <ng-container matColumnDef="iteration">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="iteration-row"> Iteration </th>
            <td mat-cell *matCellDef="let row">
              <section class="pb-3 pt-3 pl-3 pb3" *ngIf="row.status.name != 'ACTIVE'">
                <p> Change status<br> to active </p>
              </section>

              <section class="pb-3 pt-3 pl-3 pb3 row iteration-row" *ngIf="row.status.name == 'ACTIVE' ">

                  <article >
                    <app-iteration class="d-block" (sendBatch) = "changeBatch($event)" ></app-iteration>

                    <button class="btn btn-orange form-control" (click)="sendIteration(row)">Iterate</button>
                  </article>
              </section>

              <!-- No *ngIf -->
              <!--<section class="pb-3 pt-3 pl-3 pb3 row " >
                <article class="col-12">
                  <app-iteration (sendBatch) = "changeBatch($event)"></app-iteration>
                </article>
                <article class="col-12">
                  <button class="btn btn-primary form-control" (click)="sendIteration(row)">Iterate</button>
                </article>
            </section> -->
            </td>
          </ng-container>
          <!-- ------------------- End Group 5 ----------------------- -->

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

          <!-- Row shown when there is no matching data.-->
          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell" colspan="4">
              <span>Create a New Project </span>
              <button mat-icon-button color="primary" mat-raised-button aria-label="HomeButton"
                routerLink="/create-project">
                <mat-icon>edit</mat-icon>
              </button>
            </td>
          </tr>
        </table>

        <mat-paginator [pageSize]="5" [length]="projects.length" [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
      </div>
    </mat-card>
  </div>

  <!-- --------------------- Group 5 --------------------- -->
  <div class="text-center alert-viewpage" role="alert" *ngIf="iterationSuccess">
    <p class="container alert-message-viewpage text-orange"> {{iterationSuccess}} </p>
  </div>

<div class="text-center alert-viewpage" role="alert" *ngIf="iterationError">
  <p class="container alert-message-viewpage text-danger"> {{iterationError}} </p>
</div>
<!-- --------------------- End Group 5 --------------------- -->



</form>
